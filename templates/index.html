<!DOCTYPE html>
<html data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - Cenk Corapci</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <header>
        <div class="container">
            <nav>
                <h1><a href="/">Cenk Corapci</a></h1>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="/search">Search</a></li>
                    <li><a href="https://github.com/cenkcorapci" target="_blank">GitHub</a></li>
                    <li><a href="https://linkedin.com/in/cenkcorapci" target="_blank">LinkedIn</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="about-section">
            <p>I'm Cenk, a data engineer based in Netherlands. </p>
        </div>

        <div class="search-container">
            <form action="/search" method="get" class="search-form" autocomplete="off">
                <div class="search-input-wrapper">
                    <input type="text" name="q" id="search-input" placeholder="Search posts..." class="search-input">
                    <div id="suggestions" class="suggestions-list"></div>
                </div>
                <button type="submit" class="btn">Search</button>
            </form>
        </div>

        <script>
            const searchInput = document.getElementById('search-input');
            const suggestionsList = document.getElementById('suggestions');

            searchInput.addEventListener('input', async (e) => {
                const query = e.target.value.trim();
                if (query.length < 2) {
                    suggestionsList.style.display = 'none';
                    return;
                }

                try {
                    const response = await fetch(`/api/suggestions?q=${encodeURIComponent(query)}`);
                    const suggestions = await response.json();

                    if (suggestions.length > 0) {
                        suggestionsList.innerHTML = suggestions
                            .map(s => `<div class="suggestion-item">${s}</div>`)
                            .join('');
                        suggestionsList.style.display = 'block';

                        suggestionsList.querySelectorAll('.suggestion-item').forEach(item => {
                            item.addEventListener('click', () => {
                                searchInput.value = item.textContent;
                                searchInput.closest('form').submit();
                            });
                        });
                    } else {
                        suggestionsList.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Error fetching suggestions:', error);
                }
            });

            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !suggestionsList.contains(e.target)) {
                    suggestionsList.style.display = 'none';
                }
            });
        </script>

        <div class="posts-grid">
            {{if .Posts}}
            {{range .Posts}}
            <article class="post-card">
                <time datetime="{{.Date.Format " 2006-01-02"}}">{{.Date.Format "January 2, 2006"}}</time>
                <h2><a href="/post/{{.Slug}}">{{.Title}}</a></h2>
                {{if .Tags}}
                <div class="post-tags">
                    {{range .Tags}}
                    <a href="/search?q={{.}}" class="tag">{{.}}</a>
                    {{end}}
                </div>
                {{end}}
            </article>
            {{end}}
            {{else}}
            <p>No posts yet. Check back soon!</p>
            {{end}}
        </div>
    </main>


</body>

</html>