class BlogSearch{constructor(){this.posts=[],this.invertedIndex={},this.initialized=!1}async init(){if(this.initialized)return;try{const e=await fetch("/search-index.json");if(!e.ok)throw new Error("Failed to load search index");const t=await e.json();this.posts=(t.posts||[]).map(e=>({...e,tags:e.tags||[]})),this.invertedIndex=t.invertedIndex||{},this.initialized=!0,console.log("Search index loaded successfully")}catch(e){console.error("Error loading search index:",e),this.posts=[],this.invertedIndex={},this.initialized=!0}}tokenize(e){return e?(e.match(/[a-zA-Z0-9]+/g)||[]).map(e=>e.toLowerCase()):[]}search(e){if(!this.initialized||!e)return[];if(e=e.trim().toLowerCase(),!e)return[];const n=this.posts.filter(t=>(t.tags||[]).some(t=>t.toLowerCase()===e));if(n.length>0)return this.sortByDate(n);const s=this.tokenize(e);if(s.length===0)return[];let t=null;for(const n of s){const e=this.invertedIndex[n]||[];if(t===null)t=new Set(e);else{const n=new Set;for(const s of e)t.has(s)&&n.add(s);t=n}if(t.size===0)break}if(!t||t.size===0)return[];const o=this.posts.filter(e=>t.has(e.id));return this.sortByDate(o)}getSuggestions(e){if(!this.initialized||!e)return[];if(e=e.trim().toLowerCase(),e.length<2)return[];const t=new Set;for(const n of this.posts){const s=n.tags||[];for(const n of s)n.toLowerCase().startsWith(e)&&t.add(n);n.title.toLowerCase().includes(e)&&t.add(n.title)}return Array.from(t).slice(0,10)}sortByDate(e){return[...e].sort((e,t)=>new Date(t.date)-new Date(e.date))}}const blogSearch=new BlogSearch;function renderPosts(e,t){const n=document.getElementById(t);if(!n)return;if(!e||e.length===0){n.innerHTML='<p class="no-results">No posts found matching your search.</p>';return}const s=e.map(e=>{const n=new Date(e.date),s=n.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o=e.date,t=e.tags||[],i=t.length>0?`
            <div class="post-tags">
                ${t.map(e=>`<a href="/search/?q=${encodeURIComponent(e)}" class="tag">${e}</a>`).join("")}
            </div>
        `:"";return`
            <article class="post-card">
                <time datetime="${o}">${s}</time>
                <h3><a href="/post/${e.slug}/">${e.title}</a></h3>
                ${i}
            </article>
        `}).join("");n.innerHTML=s}async function initClientSearch(){await blogSearch.init();const t=document.getElementById("search-input"),e=document.getElementById("suggestions"),a=document.getElementById("search-results");if(!t||!e)return;const r=new URLSearchParams(window.location.search),s=r.get("q");if(s&&a){t.value=s;const n=blogSearch.search(s);renderPosts(n,"search-results");const e=document.getElementById("search-title");e&&(e.textContent=`Search Results for "${s}"`)}let n=-1;t.addEventListener("input",s=>{const o=s.target.value.trim();if(n=-1,o.length<2){e.style.display="none";return}const i=blogSearch.getSuggestions(o);i.length>0?(e.innerHTML=i.map((e,t)=>`<div class="suggestion-item" data-index="${t}">${e}</div>`).join(""),e.style.display="block",e.querySelectorAll(".suggestion-item").forEach(n=>{n.addEventListener("click",()=>{t.value=n.textContent,e.style.display="none",window.location.href=`/search/?q=${encodeURIComponent(n.textContent)}`})})):e.style.display="none"}),t.addEventListener("keydown",s=>{const i=e.querySelectorAll(".suggestion-item");if(i.length===0)return;if(s.key==="ArrowDown")s.preventDefault(),n=(n+1)%i.length,o(i);else if(s.key==="ArrowUp")s.preventDefault(),n=(n-1+i.length)%i.length,o(i);else if(s.key==="Enter"&&n>=0){s.preventDefault();const o=i[n];t.value=o.textContent,e.style.display="none",window.location.href=`/search/?q=${encodeURIComponent(o.textContent)}`}else s.key==="Escape"&&(e.style.display="none")});function o(e){e.forEach((e,t)=>{t===n?(e.classList.add("selected"),e.scrollIntoView({block:"nearest"})):e.classList.remove("selected")})}const i=t.closest("form");i&&i.addEventListener("submit",e=>{if(n>=0)return;e.preventDefault();const s=t.value.trim();s&&(window.location.href=`/search/?q=${encodeURIComponent(s)}`)}),document.addEventListener("click",n=>{!t.contains(n.target)&&!e.contains(n.target)&&(e.style.display="none")})}typeof window!="undefined"&&(window.BlogSearch=BlogSearch,window.blogSearch=blogSearch,window.initClientSearch=initClientSearch,window.renderPosts=renderPosts),typeof module!="undefined"&&module.exports&&(module.exports={BlogSearch,blogSearch})